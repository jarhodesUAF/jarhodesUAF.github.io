%%
%% This is file `eqexam.def',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% exerquiz.dtx  (with options: `eqexam')
%% 
\ProvidesFile{eqexam.def}
 [2012/04/13 v6.4r %
  Exerquiz support file for eqexam (dps)]
\newif\ifeq@noforms \eq@noformsfalse
\newif\ifeq@noquizsolutions \eq@noquizsolutionsfalse % dps new
\newif\ifnocorrections \nocorrectionsfalse
\newif\ifkeepdeclaredvspacing \keepdeclaredvspacingfalse
\newif\ifeq@nolink \eq@nolinkfalse
\def\eq@ckglobalhide{\ifeq@globalshowsolutions\eq@hidesolutionfalse\fi}
\def\hidesymbol{h}\def\Hidesymbol{H}
\newif\iftherearesolutions \therearesolutionsfalse
\def\SolutionsAfter{\eq@solutionsaftertrue\eq@nolinktrue}
\def\SolutionsAtEnd{\eq@solutionsafterfalse\eq@nolinkfalse}
\def\NoSpaceToWork{\let\eq@insertverticalspace=n}
\def\SpaceToWork{\let\eq@insertverticalspace=y}
\SpaceToWork
\def\ifNoSolutions#1#2{%
    \ifeq@nosolutions\expandafter#1\else
    \expandafter#2\fi
}
\newif\ifeq@randomizeChoices \eq@randomizeChoicesfalse
\newif\ifeq@randomizeallChoices \eq@randomizeallChoicesfalse
\def\turnOnRandomize{\eq@randomizeallChoicestrue}
\def\obeyLocalRandomize{\eq@randomizeallChoicesfalse}
\let\saveRandomSeed\relax
\let\inputRandomSeed\relax
\newcommand{\exsolafter}{\eq@exsolafterDefault}
\newcommand{\resetSolnAfterToDefault}{%
    \def\exsolafter{\eq@exsolafterDefault}}
\newcommand{\exsolafterDefault}[1]{\def\eq@exsolafterDefault{#1}%
    \resetSolnAfterToDefault}
\exsolafterDefault{\textit{Solution}:}
\newcommand{\renameSolnAfterTo}[1]{\def\exsolafter{#1}}
\newcommand\eq@defaultQuizLableName{Quiz}
\ifsolutionsonly
\InputIfFileExists{\jobname_xdefs.cut}{%
    \typeout{^^JExerquiz|Eqexam: Reading \jobname_xdefs.cut^^J}}
    {\PackageWarningNoLine{exerquiz|eqexam}{%
    \jobname_xdefs.cut not found.\MessageBreak
     Recompile file under the vspacewithsolns\MessageBreak
     option, then compile with the solutionsonly\MessageBreak
     option}}
\else
\newwrite\ex@solns \immediate\openout \ex@solns \jobname.sol
\newwrite\eq@xrefdefns \immediate\openout\eq@xrefdefns\jobname_xdefs.cut
\fi
\newwrite\quiz@solns \immediate\openout \quiz@solns \jobname.qsl
\def\eq@IWAuxOut#1{\immediate\write\@auxout{#1}}
\def\eq@IWDefs#1{\immediate\write\eq@xrefdefns{#1}}
\newcounter{eqexno} \setcounter{eqexno}{0}
\newcounter{@exno} \setcounter{@exno}{0}  % running exno
\newcounter{quizno} \setcounter{quizno}{0}
\renewcommand\thequizno{\alph{quizno}}
\newcounter{eqpointvalue} \setcounter{eqpointvalue}{0}
\newlength\eq@tmplength
\newcounter{eqquestionnoi}
\newcounter{eqquestionnoii}
\newcounter{eqquestionnoiii}
\newcount\@eqquestiondepth \@eqquestiondepth=0
\newcounter{questionno}
\newcounter{partno}
\renewcommand\thepartno{\alph{partno}}
\def\verbatimwrite{\@bsphack
  \let\do\@makeother\dospecials
  \catcode`\^^M\active \catcode`\^^I=12
  \def\verbatim@processline{%
    \immediate\write\verbatim@out
      {\the\verbatim@line}}%
  \verbatim@start}
\def\endverbatimwrite{\@esphack}
\providecommand\PBS[1]{\let\temp=\\#1\let\\=\temp}
\newcommand{\eqexerskip}[1]{\def\eq@exerskip{\vskip#1}}
\eqexerskip{\medskipamount}
\newcommand{\priorexskip}[1]{\def\eq@priorexskip{\vspace{#1}}}
\priorexskip{\medskipamount}
\let\eq@postexerciseHook\relax
\newcommand\eqafterexersolnskip{\string\medskip}
\def\marginparpriorhook{} % used to material before the exercise
\def\marginparafterhook{} % used to material after the exercise
\let\afterlabelhskip\space
\let\exersolnheadhook\@empty
\let\exer@solnheadhook\@empty
\newcommand{\eqexheader}
{%
        \hbox{\color{\@nolinkcolor}\if\exerstar*\exlabelformatwp\else
        \exlabelformat\fi}%
}
\def\eqexheader@wrapper{\hypertarget{qex.\the@exno}{\eqexheader}}
\newcommand{\partsformat}[1]{\def\eq@partsformat{#1}}
\partsformat{(\hfil\alph{partno}\hfil)}
\newcommand{\defaultpartsformat}{%
    \partsformat{(\hfil\alph{partno}\hfil)}}
\newcommand{\eqexlisttabheader}
{%
      \color{\@nolinkcolor}\eq@partsformat
}
\newcommand{\eq@CommonCmd}[1]{\def\eq@@CommonCmd{#1}#1}
\let\eq@@CommonCmd\@empty
\newenvironment{exercise}
{%
    \let\eqCommonCmd\eq@CommonCmd
    \par\eq@priorexskip\noindent%\begingroup % set defaults
    \def\eq@argi{eqexno}%  % use eqexno counter
    \if\eq@exerstarEnv*\def\exerstar{*}\else\def\exerstar{x}\fi
    \def\currhideopt{x}%
    \@ifnextchar[{\exercise@}{%
    \if\exerstar*%
        \def\eq@next{\@exercise}%
    \else
        \def\eq@next{\exercise@@}%
    \fi\eq@next}%
}{\eq@postexerciseHook\par\global\eq@exerciseheadingtrue\eq@exerskip}
\def\exercise@[#1]{\edef\eq@arg{#1}%
    \if\eq@arg h%
        \def\currhideopt{h}%
        \eq@hidesolutiontrue\eq@nolinktrue%
        \ifeq@globalshowsolutions
            \eq@hidesolutionfalse\eq@nolinkfalse
        \fi
        \def\eq@next{\@exercise}%   h, no *, no counter
    \else
        \if\eq@arg H%
            \edef\currhideopt{\Hidesymbol}%
            \eq@hidesolutiontrue\eq@nolinktrue%
            \ifeq@globalshowsolutions
                \eq@hidesolutionfalse\eq@nolinkfalse
            \fi
            \def\eq@next{\@exercise}%   h, no *, no counter
        \else
            \def\currhideopt{x}%
            \if\exerstar*%
                \def\eq@next{\def\eq@argi{#1}\@exercise}%
            \else
                \def\eq@next{\def\eq@argi{#1}\exercise@@}%
            \fi
        \fi
    \fi
\eq@next}
\def\exercise@@{\@ifstar{\def\exerstar{*}\@exercise}% was \exercise@@@
   {\exercise@@@}}%
\def\exercise@@@{%
\@ifnextchar[{\exercise@@@@}{\@exercise}}
\def\exercise@@@@[#1]{\def\eq@arg{#1}%
    \if\eq@arg h%
        \def\currhideopt{h}%
        \eq@hidesolutiontrue\eq@nolinktrue
        \ifeq@globalshowsolutions
            \eq@hidesolutionfalse\eq@nolinkfalse
        \fi
        \def\eq@next{\@exercise}%   h, no *, no counter
    \else
        \if\eq@arg H%
            \edef\currhideopt{\Hidesymbol}%
            \eq@hidesolutiontrue\eq@nolinktrue%
            \def\eq@next{\@exercise}%   h, no *, no counter
        \else
            \def\currhideopt{x}%
            \typeout{The option #1 is not recognized}
            \let\eq@next=\relax
        \fi
    \fi
\eq@next}
\newif\ifeq@exerciseheading \eq@exerciseheadingtrue
\newcommand\exerSolnHeader[3]
{%
    \ifeqforpaper\else\webnewpage\fi\markright{#1}\par\noindent%
    #3%
    \solnhspace
}
\let\eqEXt\@gobble
\let\endeqEXt\relax
\let\eq@writeexheader\@empty
\let\eqExtArg\@empty
\def\@exercise
{%
    \let\verbatim@out=\ex@solns
    \if\eq@argi0\else\refstepcounter{\eq@argi}\fi\stepcounter{@exno}%
    \if\exerstar*% if exercise with parts
        \eq@nolinktrue
    \else
        \if\currhideopt H%
        \else
            \ifeq@solutionsafter
                \eq@nolinktrue  % no link to solution
            \else
                \eq@ckglobalhide %
                \ifeq@hidesolution\else
                   \gdef\eq@writeexheader{\set@display@protect
                     \immediate\write\verbatim@out{%
                     \protect\eqEXt{\eqExtArg}\protect
                     \exerSolnHeader{\exsecrunhead}{ex.\the@exno}%
                     {\exsllabelformat}\exer@solnheadhook
                     \exersolnheadhook\protect\relax\space}%
                     \set@typeset@protect}%
                \fi
            \fi
        \fi
    \fi
    \ifvmode\ifdim\lastskip>\z@
        \vskip-\lastskip
    \fi\fi
    \if\exerstar*%
        \let\solution=\solnexer@woparts
        \let\endsolution=\endsolnexer@woparts
        \let\parts=\exercise@parts
        \let\endparts\endexercise@parts
    \else
        \let\solution=\solnexer@woparts
        \let\endsolution=\endsolnexer@woparts
        \let\parts=\relax
        \let\endparts=\relax
        \if\Hidesymbol h\eq@nolinkfalse\ifeq@solutionsafter
            \eq@nolinktrue\fi\fi
    \fi
    \ifeq@exerciseheading
    \prior@questionsHook\marginparpriorhook\noindent\eqexheader@wrapper
    \afterlabelhskip\marginparafterhook\ignorespaces\fi
}
\long\def\setsolnspace#1{%
    \def\newsolnspace{#1}%
    \let\solnhspace\newsolnspace
}
\let\solnhspace\space
\def\solnexer@woparts{\def\bLeaveVspace{x}% = no vertical space added
    \def\eq@next{\@ifnextchar[{\solnexer@@woparts}%
        {\solnexer@@woparts[\null]}}%
    \ifx\endparts\endexercise@parts@tabular
        \def\eq@next{\solnexer@@@woparts}%
    \fi
    \eq@next}
\let\eqPriorVspace\@gobble
\newcommand{\vspaceFiller}[1]{\vfill}
\newcommand{\vspaceFillerDefault}[1]{\vfill}
\newcommand{\vspaceFmt}[1]{%
    \ifdim\sameVspace>0pt
        \let\bLeaveVspace\@empty
        \def\leavevspace{%
            \ifx\eq@insertverticalspace y\par\eqPriorVspace{#1}%
                {\nobreak\noindent
                 \parbox[b][#1][t]{\linewidth}{\vspaceFiller{#1}}}%
            \fi
        }%
    \fi
}
\def\solnexer@@woparts[#1]{%
    \ifx#1\null\gdef\sameVspace{0pt}%
    \else
        \xdef\sameVspace{#1}%
        \ifx\sameVspace\@empty\gdef\sameVspace{0pt}\fi
        \ifvspacewithsolns\vspaceFmt{#1}\fi
        \ifeq@nosolutions\ifeq@solutionsafter\else
            \vspaceFmt{#1}\fi\fi
    \fi
    \solnexer@@@woparts
}
\def\solutionsafterSkip{\vskip\smallskipamount}
\def\eqe@debugVertSkip#1{}
\def\eqe@showEndHere#1{#1}
\def\eqe@setStartSolns{%
    \xdef\eq@startSoln{\the\pagetotal}%
    \eqe@debugVertSkip{\marginpar{\smash{b[\sameVspace]}}}%
}
\let\eqSavedComment\comment
\let\eqSavedEndCommet\endcomment
\def\solnexer@@@woparts
{%
    \def\exerwparts@cols{x}%
    \let\verbatim@out\ex@solns
    \if\currhideopt H%
        \let\procsoln\eqSavedComment
        \let\endprocsoln\eqSavedEndCommet
        \def\eq@next{\procsoln}%
    \else
        \eq@ckglobalhide
        \ifeq@hidesolution
            \let\procsoln\eqSavedComment
            \let\endprocsoln\eqSavedEndCommet
        \else
            \ifx\bLeaveVspace\@empty\leavevspace\fi
\set@display@protect
\immediate\write\verbatim@out{\eq@@CommonCmd}%
\set@typeset@protect
            \let\procsoln\verbatimwrite
            \let\endprocsoln\endverbatimwrite
        \fi
        \def\eq@next{%
            \ifeq@solutionsafter%\par
                \ifx\exsolafter\@empty
                    \ifdim\sameVspace=0pt\eqe@setStartSolns
                    \else
                        \solutionsafterSkip
                        \eqe@setStartSolns
                    \fi
                \else\par\kern0pt
                    \solutionsafterSkip
                    \noindent\strut\eqe@setStartSolns
                        \exsolafter\space\ignorespaces
                \fi
            \else
                \eq@writeexheader
                \global\let\eq@writeexheader\@empty
                \global\therearesolutionstrue\expandafter\procsoln
            \fi
        }%
    \fi
\eq@next}
\def\endsolnexerhook{}
\def\endsolnexerhookaux{}
\def\eq@fititin#1{\noindent\unskip\nobreak\hfill\penalty50
    \hskip2em\hbox{}\nobreak\hfill#1}
\let\eqfititin\eq@fititin
\newcommand\eqExerSolnTrailer
{%
    \string\ReturnTo{page.\the\c@page}%
    {\hbox{\if\exerstar*\exrtnlabelformatwp\else\exrtnlabelformat\fi}}%
    \string\endeqEXt\ifeqforpaper\string\par\eqafterexersolnskip\fi^^J
}
\def\endsolnexer@woparts
{%
    \if\currhideopt H%
        \ifkeepdeclaredvspacing\vskip\sameVspace\fi
        \csname endprocsoln\endcsname
    \else
        \ifeq@solutionsafter
            \eq@fititin{\hbox{\exrtnlabelformat}}\par\kern0pt
            \ifkeepdeclaredvspacing
                \@tempdima\pagetotal \advance\@tempdima-\eq@startSoln
                \@tempdimb\sameVspace
                \ifdim\@tempdimb>0pt
                    \advance\@tempdimb-\@tempdima
                    \ifdim\@tempdimb>0pt\vglue\@tempdimb\kern0pt
                        \let\eqe@showEndHere\@gobble
                        \edef\tmp@exp{\noexpand\marginpar{%
                        \noexpand\smash{e: adj \the\@tempdimb}}}%
                        \eqe@debugVertSkip{\tmp@exp}%
                    \fi
                \fi
            \fi
            \eqe@showEndHere{\eqe@debugVertSkip{\marginpar{\smash{e}}}}%
        \else
            \endprocsoln
            \eq@ckglobalhide
            \ifeq@hidesolution\else
                \endsolnexerhookaux
                \set@display@protect
                \immediate\write\verbatim@out{\eqExerSolnTrailer}%
                \set@typeset@protect
            \fi
        \fi
    \fi
\endsolnexerhook}
\let\eq@exerstarEnv\relax
\newenvironment{exercise*}{\def\eq@exerstarEnv{*}\exercise}
{\endexercise}
\def\exercise@parts{\@@par\ifdim\parskip>\z@\vskip-\parskip\fi
  \def\exerwparts@cols{x}\@ifnextchar[%
  {\let\endparts=\endexercise@parts@tabular\exercise@parts@tabular@}%
  {\let\endparts=\endexercise@parts@list\exercise@parts@list}}
\def\eq@extralabelsep{0pt}
\newcommand{\setPartsWidth}[1]{\def\parts@indent{\normalfont#1}}
\setPartsWidth{(d)}
\def\eqe@prtsepPrb{\ }
\let\prior@parts@hook\@empty
\let\post@parts@hook\@empty
\let\eqp@rtc@lcm@rk\relax
\let\eq@insertContAnnot\relax
\def\eq@item@common{\eq@insertContAnnot\eqp@rtc@lcm@rk
    \def\currhideopt{x}\eq@hidesolutionfalse\eq@nolinkfalse
    \@ifnextchar[\@ckhide\eq@item}
\newcommand{\eqpartsitemsep}[1]{\def\eqparts@itemsep{#1}}
\eqpartsitemsep{0pt}
\newenvironment{exercise@parts@list}
{\settowidth{\eq@tmplength}{\parts@indent}%
\eq@initializeContAnnot\eq@nolinkfalse\prior@parts@hook
\list{\normalfont
    \if\Hidesymbol h\eq@nolinkfalse\ifeq@solutionsafter
        \eq@nolinktrue\fi\fi
    \if\currhideopt H%
    \else
        \ifeq@solutionsafter
            \eq@nolinktrue  % no link to solution
        \else
            \ifeq@nosolutions
                \eq@nolinktrue  % no link to solution
            \else
                \eq@ckglobalhide
                \ifeq@hidesolution\eq@nolinktrue\else
                    \gdef\eq@writeexheader{\set@display@protect
                    \immediate\write\verbatim@out{%
                    \protect\eqEXt{\eqExtArg}\protect
                    \exerSolnHeader{\exsecrunhead}%
                    {ex.\the@exno\alph{partno}}{\exsllabelformatwp}%
                    \exer@solnheadhook\exersolnheadhook\relax}%
                    \set@typeset@protect}%
                \fi
            \fi
        \fi
    \fi
    \makebox[\eq@tmplength]{\eqexlisttabheader}%
}{%
    \usecounter{partno}%
    \setlength{\topsep}{3pt}%
    \setlength{\partopsep}{0pt plus 1pt minus 1pt}%
    \setlength{\parsep}{0pt}\setlength{\itemindent}{0pt}%
    \setlength{\listparindent}{\parindent}%
    \setlength{\itemsep}{\eqparts@itemsep}
    \settowidth{\labelsep}{\normalfont\eqe@prtsepPrb}%
    \addtolength{\labelsep}{\eq@extralabelsep}%
    \settowidth{\labelwidth}{\parts@indent}%
    \setlength{\leftmargin}{\labelwidth}%
    \addtolength{\leftmargin}{\labelsep}%
    \let\eq@item\item
    \def\eqthisenv{parts}%
    \def\item{\ifx\@currenvir\eqthisenv
        \def\eq@next{\eq@item@common}\else
        \def\eq@next{\eq@item}\fi
    \eq@next}%
}}{\endlist\post@parts@hook}
\def\eq@initializeContAnnot{\@ifundefined{eqequestions}{%
    \global\let\eqeCurrProb\relax}{%
    \xdef\eqeCurrProb{\theeqquestionnoi}}%
    \xdef\eq@currProbStartPage{\arabic{page}}%
}
\def\exercise@parts@tabular@[#1]{%
  \def\exerwparts@cols{#1}\exercise@parts@tabular}
\newenvironment{exercise@parts@tabular}
{%
    \setcounter{partno}{0}%
    \settowidth{\eq@tmplength}{\parts@indent\eqe@prtsepPrb}%
    \sbox{\eq@tmpbox}{\parts@indent}%
    \let\eq@item@saved\item
    \let\eq@item\item@part@tabular
    \def\eqthisenv{parts}%
    \def\item{\ifx\@currenvir\eqthisenv
        \def\eq@next{\eq@item@common}\else
        \def\eq@next{\eq@item@saved}\fi
    \eq@next}\eq@nolinkfalse
    \eq@tmpdima=\linewidth \divide\eq@tmpdima by\exerwparts@cols
    \vskip\partopsep\noindent\normalbaselines\tabcolsep=0pt
    \tabular{*{\exerwparts@cols}{p{\eq@tmpdima}}}%
}{\endtabular}
\def\item@part@tabular{\leavevmode\refstepcounter{partno}%
  \eq@solutionsafterfalse % no solutionsafter are allowed
  \ifeq@solutionsafter
    \eq@nolinktrue  % no link to solution
  \else\ifeq@nosolutions
    \eq@nolinktrue  % no link to solution
  \else
      \eq@ckglobalhide
      \ifeq@hidesolution\eq@nolinktrue\else
      \gdef\eq@writeexheader{%
        \set@display@protect
        \immediate\write\verbatim@out{%
        \protect\eqEXt{\eqExtArg}\string\exerSolnHeader{\exsecrunhead}%
            {ex.\the@exno\alph{partno}}{\exsllabelformatwp}\relax}%
        \set@typeset@protect
      }%
  \fi\fi\fi
  \PBS\raggedright
  \settowidth{\eq@tmplength}{\parts@indent\eqe@prtsepPrb}%
  \sbox{\eq@tmpbox}{\parts@indent}%
  \eq@tmpdima=\wd\eq@tmpbox
  \addtolength\eq@tmplength{\eq@extralabelsep}%
  \hangindent=\eq@tmplength\hangafter=1\relax
  \makebox[\eq@tmpdima]{\eqexlisttabheader}\eqe@prtsepPrb
  \ignorespaces
}
\def\@ckhide[#1]{\edef\eq@arg{#1}%
    \def\currhideopt{x}%
    \ifx\eq@arg\@empty\else
    \if\eq@arg H%
        \eq@hidesolutiontrue\eq@nolinktrue%
        \edef\currhideopt{\Hidesymbol}%
    \else
        \ifeq@globalshowsolutions\else
            \if\eq@arg h%
                \eq@hidesolutiontrue\eq@nolinktrue%
                \def\currhideopt{h}%
            \fi
        \fi
    \fi\fi
    \eq@item
}
\def\includeexersolutions{%
       \include@solutions\global\let\include@solutions\relax
}
\let\eqsolutionshook\@empty
\let\priorexsectitle\@empty
\let\priorexslinput\@empty
\def\exerSolnsHeadnToc{\section*{\exsectitle}%
    \addcontentsline{toc}{section}{%
    \@ifundefined{web@latextoc}{}{%
    \ifx\web@latextoc y\else
    \protect\numberline{}\fi}\exsectitle}}
\@ifpackageloaded{web}{\def\eq@normallheader{\lheader{\rightmark}}}
    {\let\eq@normallheader\relax}
\@ifpackageloaded{web}{\def\eq@defaultlheader{\lheader{\aeb@setmarks}}}
    {\let\eq@defaultlheader\relax}
\newcommand{\exerSolnInput}
{%
    \let\webnewpage\relax
    \ifsolutionsonly\else\immediate\closeout\ex@solns\fi
    \ifeq@nosolutions\else
        \iftherearesolutions
            \ifsolutionsonly\eqsolutionshook
        \else
            \newpage\eqsolutionshook\markright{}\eq@normallheader
        \fi
        \markright{\exsectitle}%
            \ifx\webnewpage\relax
                \def\webnewpage{\let\webnewpage\newpage}%
            \fi
            \priorexsectitle\exerSolnsHeadnToc\priorexslinput
            \InputIfFileExists{\jobname.sol}{}{\PackageWarning{exerquiz}
            {!!! Solutions to exercises not found}}%
            \newpage\eq@defaultlheader
        \fi
    \fi
}
\def\include@solutions{%
        \exerSolnInput
}
\newcommand{\prior@questionsHook}{}
\let\qMark@Hook\@empty
\let\aeb@titleQuiz\@empty
\newcommand{\post@questionsHook}{}
\renewcommand{\theeqquestionnoi}{\arabic{eqquestionnoi}}
\newcommand{\labeleqquestionnoi}{%
    \color{blue}\bfseries\theeqquestionnoi.}
\renewcommand{\theeqquestionnoii}{\alph{eqquestionnoii}}
\newcommand{\labeleqquestionnoii}{%
    \color{blue}\bfseries(\theeqquestionnoii)}
\renewcommand{\theeqquestionnoiii}{\roman{eqquestionnoiii}}
\newcommand{\labeleqquestionnoiii}{%
    \color{blue}\bfseries(\theeqquestionnoiii)}
\newenvironment{questions}
{%
    \ifnum\@eqquestiondepth>\tw@\@toodeep\else
    \advance\@eqquestiondepth\@ne\fi
    \def\@quesctr{eqquestionno\romannumeral\the\@eqquestiondepth}%
    \list{\qMark@Hook\prior@questionsHook\gdef\eqPTs{1}%
    \global\let\eqQT\eq@na%
    {\@tempcnta=0 \let\@thispr@b\@empty
     \@whilenum\@tempcnta<\@eqquestiondepth\do{\advance\@tempcnta\@ne
     \ifx\@thispr@b\@empty\edef\@thispr@b{%
     \csname theeqquestionno\romannumeral\the\@tempcnta\endcsname}\else
     \edef\@thispr@b{\@thispr@b%
     (\csname theeqquestionno\romannumeral\the\@tempcnta\endcsname)}\fi
    }\xdef\@currentQues{\@thispr@b}}%
    \makebox[\labelwidth][r]{\normalfont\bfseries
    \csname label\@quesctr\endcsname}\xdef\eq@pageThisQ{\the\c@page}%
    \post@questionsHook}{\usecounter{\@quesctr}%
    \settowidth{\labelwidth}{\normalfont\bfseries00.\ }%
    \setlength{\topsep}{3pt}\setlength{\parsep}{0pt}%
    \setlength{\itemindent}{0pt}\setlength{\itemsep}{3pt}%
    \setlength{\leftmargin}{\labelwidth}%
    \settowidth{\labelsep}{\ }}%
}{\endlist}
\def\pushquestions{%
    \expandafter\xdef\csname save\@quesctr\endcsname{%
        \expandafter\the\csname c@\@quesctr\endcsname}%
    \end{questions}}
\def\popquestions{%
    \begin{questions}
    \setcounter{\@quesctr}{\csname save\@quesctr\endcsname}}
\def\sq@priorhook{\medskip\noindent}
\def\sq@afterhook{}
\def\@shortquizCnt{0}
\def\@sqGenBaseName{eqSqBn\@shortquizCnt}
\newenvironment{shortquiz}
{%
    \xdef\eq@pageThisQ{\the\c@page}%
    \let\@currentQues\@empty
    {\count0=\@shortquizCnt \advance\count0by1\relax
        \xdef\@shortquizCnt{\the\count0}}%
    \goodbreak\@ifstar{\sqForms\@shortquiz}%
        {\sqLinks\@shortquiz}%
}{\aeb@endshortquiz}
\newenvironment{shortquiz*}
{%
    \xdef\eq@pageThisQ{\the\c@page}%
    {\count0=\@shortquizCnt\advance\count0by1\relax
        \xdef\@shortquizCnt{\the\count0 }}%
    \sqForms\@shortquiz
}{\aeb@endshortquiz}
\def\@shortquiz{\@ifnextchar[%
    {\@@shortquiz}{\@@shortquiz[\@sqGenBaseName]}}
\def\@@shortquiz[#1]{%\begingroup
  \gdef\oField{#1}\gdef\curr@quiz{#1}\gdef\currQuiz{#1}%
    \global\let\eqQzQuesList\@empty
    \let\eq@AddProbToQzQuesList\relax
    \edef\@currentlabel{\@shortquizCnt}%
    \edef\@currentHref{shortquiz.\@shortquizCnt}%
    \ifx\aeb@@titleQuiz\@empty
        \def\@currentlabelname{\eq@defaultQuizLableName}\else
        \protected@edef\@currentlabelname{\@currentlabelname}\fi
  \global\let\eqQuizType=s\let\@qzsolndest\@empty
  \if\sqstar*\relax
    \let\@Ans\Ans@sq@f
    \ifx\oField\@empty
        \typeout{^^JExerquiz: Base field name required when using
                shortquiz with '*' option}
        \typeout{Exerquiz: Assuming link style^^J}
        \let\@Ans\Ans@sq@l
    \fi
  \else
     \let\@Ans\Ans@sq@l
  \fi
  \setcounter{questionno}{0}%
  \let\answers\answers@sq
  \let\endanswers\endanswers@sq
  \let\manswers\manswers@sq
  \let\endmanswers\endmanswers@sq
  \let\solution\solution@sq
  \let\endsolution\endsolution@sq
}
\def\aftershortquizskip{\medskip}
\def\aeb@endshortquiz{\setcounter{quizno}{0}%
    \sq@afterhook
    \global\let\sqlabel\eq@sqlabel
    \global\let\sqslrtnlabel\eq@sqslrtnlabel
    \global\let\sqsllabel\eq@sqsllabel
    \par\aftershortquizskip
}
\def\sqLinks{\def\sqstar{}}\sqLinks
\def\sqForms{\def\sqstar{*}}
\let\eq@tq@star\relax
\def\sqPriorSolutionAfterSkip{\smallskip}
\def\solution@sq{\let\eq@next\relax
  \ifx\@qzsolndest\@empty
    \typeout{exerquiz: * Solutions unexpected here *}%
    \typeout{exerquiz: * Will assume 'solutionsafter' option *}%
    \eq@solutionsaftertrue
  \fi
  \ifeq@solutionsafter
    \par\sqPriorSolutionAfterSkip\noindent
    \sqsolafter
  \else
    \global\therearequizsolutionstrue\let\verbatim@out=\quiz@solns
    \set@display@protect
    \immediate\write\verbatim@out{%
      \ifx\eqQuizType q\string\eqQt\else\string\eqSQt\fi%
      \string\quizSolnHeader\ifx\eqQuizType q\ifx\allow@peek n%
        [{\curr@quiz}{\currQuizStartPage}]\fi\fi%
        {\@qzsolndest}{\sqsllabel}\relax}%
    \set@typeset@protect
    \expandafter\verbatimwrite\fi
}
\def\sqSolutionsAfterSkip{\par\bigskip}
\def\endsolution@sq
{%
    \ifeq@solutionsafter
        \eq@fititin{\hbox{\sqslrtnlabel}}\sqSolutionsAfterSkip
    \else
        \endverbatimwrite
        \ifx\@qzsolndest\@empty\else\set@display@protect
            \immediate\write\verbatim@out{\eqSqSolnTrailer}%
         \set@typeset@protect
        \fi
    \fi
    \global\let\@qzsolndest\@empty
}
\def\fpAfterSolutionsSkip{\par\medskip}
\newcommand\eqSqSolnTrailer{%
    \ifx\eqQuizType q%
        \string\ReturnTo{page.\eq@pageThisQ}%
            {\hbox{\sqslrtnlabel}}\string\endeqQt
    \else
        \string\ReturnTo{page.\eq@pageThisQ}%
            {\hbox{\sqslrtnlabel}}\string\endeqSQt
    \fi
    \ifeqforpaper\string\fpAfterSolutionsSkip\fi^^J%
}
\let\eqSQt\relax
\let\endeqSQt\relax
\let\eqQt\relax
\let\endeqQt\relax
\newcommand\quizSolnHeader[3][]{%
    \ifeqforpaper\else\webnewpage\fi\noindent
    #2%
    \solnhspace
}
\newif\iftherearequizsolutions \therearequizsolutionsfalse
\let\aeb@FLOverride\relax
\def\includequizsolutions
{%
        \include@quizsolutions
        \let\include@quizsolutions\relax
}
\let\aeb@titleQuiz\@empty
\let\aeb@@titleQuiz\@empty
\def\answers@sq{\stepcounter{questionno}%
    \if\sqstar*\relax
        \if\aeb@FLOverride l
            \let\@Ans\Ans@sq@l\else
            \let\@Ans\Ans@sq@f\fi
    \else
        \if\aeb@FLOverride f
            \let\@Ans\Ans@sq@f\else
            \let\@Ans\Ans@sq@l\fi
    \fi
    \def\aeb@answerType{r}\@ifnextchar[{\answers@@sq}%
    {\@ifstar{\answers@@sq[\curr@quiz.\thequestionno]}{\answers@@sq[]}}}
\def\manswers@sq{\stepcounter{questionno}%
    \if\sqstar*\relax
        \if\aeb@FLOverride l\let\@An\Ans@ck@sq@f\fi
    \else
        \if\aeb@FLOverride f
            \let\@An\Ans@ck@sq@f\else
            \let\@Ans\Ans@ck@sq@l\fi
    \fi
    \def\aeb@answerType{c}\@ifnextchar[{\answers@@sq}%
    {\@ifstar{\answers@@sq[\curr@quiz.\thequestionno]}{\answers@@sq[]}}}
\let\sq@hwdest\@empty % hard-wired destination
\def\answers@@sq[#1]#2{%
    \gdef\aeb@numCols{#2}%
    \ifx\sq@hwdest\@empty
        \xdef\@qzsolndest{#1}\else
        \gdef\@qzsolndest{\sq@hwdest}\fi
    \ifx#21\gdef\eq@listType{1}\expandafter\answers@sq@list\else
    \gdef\eq@listType{0}\expandafter\answers@@sq@tabular\fi{#2}%
}
\def\eq@hspanner{\ }
\def\eq@hspanner@default{\ }
\def\eq@lw@l{\eq@l@l\eq@hspanner}
\def\setMClabelsep#1{\def\eq@hspanner{#1}}
\def\resetMClabelsep{\let\eq@hspanner\eq@hspanner@default}
\def\eq@l@l{\normalsize\normalfont(d)}
\def\eq@lw@f{\kern\RadioFieldSize\eq@hspanner}
\newcommand\Ans@list[2][0]{\gdef\eq@pPTs{#1}%
    \xdef\Ans@choice{#2}\item\relax\if\eq@listType1%
    \addtocounter{quizno}{-1}\refstepcounter{quizno}\fi}
\newenvironment{answers@sq@list}[1]
{%
    \if\aeb@answerType r
        \let\endanswers\endanswers@sq@list\else
        \let\endmanswers\endanswers@sq@list\fi
    \ifinner\else\vskip\aboveanswersSkip\fi
    \list{\strut\@Ans\eq@hspanner}%
    {%
        \if\sqstar*\relax
            \settowidth{\labelwidth}{\eq@lw@f\eq@hspanner}\else
            \settowidth{\labelwidth}{\eq@lw@l\eq@hspanner}\fi
        \setlength{\parsep}{0pt}\setlength{\itemindent}{0pt}%
        \setlength{\topsep}{0pt}\setlength{\partopsep}{0pt}%
        \setlength{\listparindent}{\parindent}%
        \setlength{\leftmargin}{\labelwidth}%
        \setlength{\labelsep}{0pt}%
        \def\Ans{\Ans@list}%
    }%
}%
{\endlist\setcounter{quizno}{0}}
\newcommand\Ans@tabular[2][0]{\gdef\eq@pPTs{#1}%
    \xdef\Ans@choice{#2}\leavevmode\@Ans
}
\def\answers@@sq@tabular#1{%
    \vskip\aboveanswersSkip\noindent\tabcolsep=0pt
    \eq@tmpdima=\linewidth \divide \eq@tmpdima by#1 %
    \def\Ans{\Ans@tabular}%
    \begin{tabular}{*{#1}{p{\eq@tmpdima}}}}%
\def\endanswers@sq{\end{tabular}\setcounter{quizno}{0}}%
\def\endmanswers@sq{\end{tabular}\setcounter{quizno}{0}}%
\def\popiiictm{\special{CTM: pop pop pop}}
\def\linkContentFormat{%
    \if\probstar*\Alph{quizno}\else\alph{quizno}\fi}
\def\linkContentWrapper{(\hfil\linkContentFormat\hfil)}%
\def\Ans@sq@l{%
    \leavevmode\if\eq@listType1\stepcounter{quizno}%
    \else\refstepcounter{quizno}\fi\PBS\raggedright
    \settowidth{\eq@tmplength}{\eq@lw@l}\sbox{\eq@tmpbox}{\eq@l@l}%
    \eq@tmpdima=\wd\eq@tmpbox
    \def\link@@Content{\linkContentWrapper}%
    \hangindent=\eq@tmplength\hangafter=1\relax
    \Ans@sq@l@driver
\eq@hspanner\ignorespaces}
\let\Ans@ck@sq@l=\Ans@sq@l
\def\Ans@sq@f{%
    \if\eq@listType1\stepcounter{quizno}%
    \else\refstepcounter{quizno}\fi\PBS\raggedright
    \settowidth{\eq@tmplength}{\eq@lw@f}%
    \eq@tmpdima=\wd\eq@tmpbox%
    \hangindent=\eq@tmplength\hangafter=1\relax
    \insertGrayLetters % 6.3d
    \Ans@sq@f@driver
\eq@hspanner\ignorespaces}
\let\Ans@ck@sq@f=\Ans@sq@f
\newskip\aboveanswersSkip
\setlength\aboveanswersSkip{3pt}
\def\insertGrayLetters{\ifaebshowgrayletters
    \rlap{\makebox[\RadioFieldSize]%
        {\textcolor{gray}{\Alph{quizno}}}}\else\relax\fi}
\newcount\eq@tabColCnt
\define@key{bchoice}{nCols}{\def\bChoiceNumCols{#1}}
\@for\eqi:=1,2,3,4,5,6,7,8,9,10 \do{\edef\temp@expand@def{%
    \noexpand\define@key{bchoice}{\eqi}[\eqi]{%
        \noexpand\def\noexpand\bChoiceNumCols{\eqi}}%
    }\temp@expand@def
}
\def\bChoiceNumCols{\aeb@numCols}
\define@key{bchoice}{random}[true]{%
    \csname if#1\endcsname\eq@randomizeChoicestrue
        \else\eq@randomizeChoicesfalse\fi
}
\define@key{bchoice}{label}[]{%
    \xdef\bChoiceLabel{#1}%
}
\def\bChoices{\@ifnextchar[{\@ansChoices}{\@ansChoices[\aeb@numCols]}}
\def\@ansChoices[#1]%
{%
    \global\let\@tempholdSaveAns\@empty %4/5
    \global\let\@tempholdSaveChoice\@empty %4/5
    \global\let\bChoiceLabel\@empty %4/5
    \setkeys{bchoice}{#1}%
    \global\eq@tabColCnt=0
    \ifnum\aeb@numCols=1 % list mode
        \def\eq@next{\@layoutListAns}%
    \else % tabular mode
         \def\eq@next{\@layoutTabularAns{\bChoiceNumCols}}%
    \fi
    \eq@next
}
\let\eChoices\relax
\def\@layoutListAns{\@ifnextchar\Ans{\@getListAns}%
    {\@lookforendansChoices{\@layoutListAns}}%
}
\newcommand{\eq@saveAns}[2][]{%
    \let\eq@next\@@@SaveAnsGobbleAns
    \ifx\bChoiceLabel\@empty\else
    \def\eq@savedAnsOpt{#1}\def\eq@savedAnsZO{#2}%
    \if\eq@savedAnsZO1 \let\eq@next\@@@SaveAns\fi
    \fi\eq@next
}
\long\def\@@@SaveAns#1\eAns{% 4/5
    \g@addto@macro\@tempholdSaveAns{\\{\ignorespaces#1}}%
    \addtocounter{quizno}{1}%
    \edef\temp@expand{\noexpand\g@addto@macro\noexpand
    \@tempholdSaveChoice{%
        \noexpand\\{\ifx\sqstar\@empty\linkContentFormat\else
        \ifaebshowgrayletters\Alph{quizno}\else
        \thequizno\fi\fi}}}\temp@expand
    \addtocounter{quizno}{-1}%
}
\def\eq@insertComma{\ifx\eq@comma\@empty\def\eq@comma{,}\else
    \eq@comma\space\fi}
\long\def\eq@displayAns#1{\eq@insertComma#1} % 4/5
\def\eq@displayAlts#1{\eq@insertComma(#1)} % 4/5
\newcommand{\useSavedAns}[2][]{% 4/5
    \bgroup
        \def\eq@argi{#1}\ifx\eq@argi\@empty
            \let\eq@comma\@empty\let\label\@gobble
            \let\\\eq@displayAns\csname SavedAns#2\endcsname\else
            \csname SavedAns#2-Idx#1\endcsname\fi
    \egroup
} % 4/5
\newcommand{\useSavedAlts}[2][]{%
    \bgroup
        \def\eq@argi{#1}\ifx\eq@argi\@empty
            \let\eq@comma\@empty
            \let\\\eq@displayAlts\csname SavedAlts#2\endcsname\else
            (\csname SavedAlts#2-Idx#1\endcsname)\fi
    \egroup
} % 4/5
\newcommand{\useSavedAltsAns}[2][]{%
    \bgroup
        \def\eq@argi{#1}\ifx\eq@argi\@empty
            \csname SavedAltsAns#2\endcsname\else
            (\csname SavedAlts#2-Idx#1\endcsname)
            \csname SavedAns#2-Idx#1\endcsname\fi
    \egroup
} %4/5
\newcommand{\useSavedNumAns}[1]{\csname NumAns#1\endcsname}
\long\def\@@@SaveAnsGobbleAns#1\eAns{} % 4/5
\long\def\@getListAns\Ans#1\eAns{%
    \eq@saveAns#1\eAns % 4/5
    \Ans#1\vspace{\@rowskip}%
    \@layoutListAns
}
\long\def\@lookforendansChoices#1{%
    \@ifnextchar\eChoices{\rowsep{\rowsep@default}%
        \expandafter\@findendans\@gobble}{\expandafter#1\@gobble}%
}
\def\@layoutTabularAns#1{%
    \let\eq@tabSep=\@empty
    \xdef\numShortCols{#1}%
    \ifnum#1>\aeb@numCols \xdef\numShortCols{\aeb@numCols}\fi
    \@@layoutTabularAns
}
\def\@@layoutTabularAns{%
    \@ifnextchar\Ans{\@getTabAns}%
        {\@lookforendansChoices{\@@layoutTabularAns}}%
}
\def\rowsep#1{\gdef\@rowsep{[#1]}\gdef\@rowskip{#1}}%
    \rowsep{\rowsep@default}
\def\rowsepDefault#1{\def\rowsep@default{#1}}
\def\rowsep@default{0pt}
\long\def\@getTabAns\Ans#1\eAns{%
    \eq@saveAns#1\eAns
    \global\advance\eq@tabColCnt1
    \let\@save@tabSep=\eq@tabSep
    \ifnum\eq@tabColCnt=\numShortCols
        \global\eq@tabColCnt=0
            \xdef\eq@tabSep{\noexpand\\\noalign{\kern\@rowskip\relax}}%
    \else
        \gdef\eq@tabSep{&}%
    \fi
    \@ifnextchar\eChoices{\@save@tabSep\Ans#1\rowsep{\rowsep@default}
        \expandafter\@findendans\@gobble}%
        {\@save@tabSep\Ans#1\@@layoutTabularAns}%
}
\def\@findendans{\@ifnextchar\end{% 4/5
    \ifx\bChoiceLabel\@empty\else
    \processLabeledAns\fi
    }{\expandafter\@findendans\@gobble}}%
\def\defineEachAns#1{\advance\count0by1\relax
    \@temptokena={#1}\expandafter\xdef
    \csname SavedAns\bChoiceLabel-Idx\the\count0\endcsname{#1}%
    \ifsolutionsonly\else{\let\\\relax\eq@IWDefs{%
    \string\expandafter\string\gdef\string\csname\space
    SavedAns\bChoiceLabel-Idx\the\count0%
    \string\endcsname{\the\@temptokena}}}\fi
}
\def\defineEachChoice#1{\advance\count0by1\relax
    \@temptokena={#1}\expandafter\xdef
    \csname SavedAlts\bChoiceLabel-Idx\the\count0\endcsname{#1}%
    \ifsolutionsonly\else{\let\\\relax\eq@IWDefs{%
    \string\expandafter\string\gdef\string\csname\space
    SavedAlts\bChoiceLabel-Idx\the\count0%
    \string\endcsname{\the\@temptokena}}}\fi
}
\def\processLabeledAns{% 4/5 \@tempholdSaveAns \@tempholdSaveChoice
    \bgroup
        \let\label\@gobble
        \toks@=\expandafter{\@tempholdSaveAns}\expandafter
        \xdef\csname SavedAns\bChoiceLabel\endcsname{\the\toks@}%
        \ifsolutionsonly\else{\let\\\relax\eq@IWDefs{%
        \string\expandafter\string\gdef\string\csname\space
        SavedAns\bChoiceLabel\string\endcsname{\the\toks@}}}\fi
        \count0=0\relax\let\\\defineEachAns\the\toks@
        \xdef\@currNCntAns{\the\count0 }\expandafter
        \xdef\csname NumAns\bChoiceLabel\endcsname{\@currNCntAns}%
        \ifsolutionsonly\else{\eq@IWDefs{%
        \string\expandafter\string\gdef\string\csname\space
        NumAns\bChoiceLabel\string\endcsname{\the\count0 }}}\fi
        \toks@=\expandafter{\@tempholdSaveChoice}\expandafter
        \xdef\csname SavedAlts\bChoiceLabel\endcsname{\the\toks@}%
        \ifsolutionsonly\else{\let\\\relax\eq@IWDefs{%
        \string\expandafter\string\gdef\string\csname\space
        SavedAlts\bChoiceLabel\string\endcsname{\the\toks@}}}\fi
        \count0=0\relax\let\\\defineEachChoice\the\toks@
        \count0=1\relax\toks@={\ignorespaces\@gobble}%
        \loop
            \edef\temp@exp{\the\toks@, %
            \noexpand\useSavedAlts[\the\count0]{\bChoiceLabel}
            \noexpand\useSavedAns[\the\count0]{\bChoiceLabel}}%
            \toks@=\expandafter{\temp@exp}%
            \ifnum\count0<\@currNCntAns
            \advance\count0by1
        \repeat
        \expandafter
        \xdef\csname SavedAltsAns\bChoiceLabel\endcsname{\the\toks@}%
        \ifsolutionsonly\else{\let\\\relax\eq@IWDefs{%
        \string\expandafter\string\gdef\string\csname\space
        SavedAltsAns\bChoiceLabel\string\endcsname{\the\toks@}}}\fi
    \egroup
}
\def\graylettersOn{\aebshowgrayletterstrue}
\def\graylettersOff{\aebshowgraylettersfalse}
\def\aeb@exiii{\expandafter\expandafter\expandafter}
\def\REF{\@ifstar{\let\isREFstar=1\aeb@REFstar}
    {\let\isREFstar=0\aeb@REF}}
\def\aeb@REFstar#1{\@ifundefined{r@#1}{\hbox{\reset@font\bfseries ??}}
    {\ifaebshowgrayletters\aeb@buildUpperCaseRef{#1}%
     \else\ref*{#1}\fi}%
}
\def\aeb@REF#1{\@ifundefined{r@#1}{\hbox{\reset@font\bfseries ??}}
    {\ifaebshowgrayletters\aeb@buildUpperCaseRef{#1}%
     \else\ref{#1}\fi}%
}
\def\aeb@buildUpperCaseRef#1{%
    \xdef\tmp@expand{\aeb@exiii\@firstoftwo\csname r@#1\endcsname}%
    \xdef\tmp@expand{\uppercase{\tmp@expand}}\tmp@expand
}
\endinput
%%
%% End of file `eqexam.def'.
